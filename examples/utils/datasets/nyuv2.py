import os
import numpy as np

from .base import _download


class NYULoader:
    """
    NYU Depth V2 Dataset
    """

    DATASET_URL = "http://horatio.cs.nyu.edu/mit/silberman/nyu_depth_v2/nyu_depth_v2_labeled.mat"
    MAT_FILENAME = "nyu_depth_v2_labeled.mat"
    NAMES_TO_IDS = {"air conditioner": "79", "air duct": "38", "air vent": "25", "alarm": "525", "alarm clock": "156", "album": "822", "aluminium foil": "708", "american flag": "870", "antenna": "796", "apple": "334", "ashtray": "377", "avocado": "680", "baby chair": "494", "baby gate": "591", "back scrubber": "656", "backpack": "206", "bag": "55", "bag of bagels": "690", "bag of chips": "245", "bag of flour": "285", "bag of hot dog buns": "747", "bag of oreo": "692", "bagel": "689", "baking dish": "260", "ball": "60", "balloon": "385", "banana": "147", "banana peel": "691", "banister": "453", "bar": "51", "bar of soap": "564", "barrel": "343", "baseball": "825", "basket": "39", "basketball": "542", "basketball hoop": "162", "bassinet": "414", "bathtub": "136", "bean bag": "797", "bed": "157", "bed sheets": "352", "bedding package": "808", "beeper": "780", "belt": "610", "bench": "204", "bicycle": "189", "bicycle helmet": "337", "bin": "307", "binder": "399", "blackboard": "225", "blanket": "312", "blender": "268", "blinds": "80", "board": "408", "book": "1", "book holder": "827", "bookend": "374", "bookrack": "224", "books": "85", "bookshelf": "88", "boomerang": "773", "bottle": "2", "bottle of comet": "755", "bottle of contact lens solution": "633", "bottle of hand wash liquid": "677", "bottle of ketchup": "750", "bottle of liquid": "685", "bottle of listerine": "676", "bottle of perfume": "840", "bottle of soap": "502", "bowl": "22", "box": "26", "box of paper": "503", "box of ziplock bags": "271", "bracelet": "860", "bread": "246", "brick": "695", "briefcase": "617", "broom": "328", "bucket": "427", "bulb": "688", "bunk bed": "804", "business cards": "535", "butterfly sculpture": "712", "button": "774", "cabinet": "3", "cable box": "168", "cable modem": "73", "cable rack": "104", "cables": "450", "cactus": "641", "cake": "289", "calculator": "200", "calendar": "583", "camera": "40", "can": "329", "can of beer": "857", "can of food": "280", "can opener": "279", "candelabra": "605", "candle": "137", "candlestick": "148", "cane": "555", "canister": "794", "cannister": "355", "cans of cat food": "593", "cap stand": "441", "car": "530", "cardboard sheet": "452", "cardboard tube": "413", "cart": "305", "carton": "397", "case": "851", "casserole dish": "365", "cat": "594", "cat bed": "608", "cat cage": "580", "cat house": "856", "cd": "207", "cd disc": "585", "ceiling": "4", "celery": "720", "cell phone": "290", "cell phone charger": "602", "centerpiece": "878", "ceramic frog": "643", "certificate": "790", "chair": "5", "chalkboard": "428", "chandelier": "342", "chapstick": "726", "charger": "743", "charger and wire": "574", "chart": "411", "chart roll": "495", "chart stand": "393", "chessboard": "198", "chest": "344", "child carrier": "491", "chimney": "702", "circuit breaker box": "112", "classroom board": "392", "cleaner": "548", "cleaning wipes": "381", "clipboard": "536", "clock": "56", "cloth bag": "492", "cloth drying stand": "549", "clothes": "141", "clothing detergent": "501", "clothing dryer": "498", "clothing drying rack": "556", "clothing hamper": "770", "clothing hanger": "214", "clothing iron": "572", "clothing washer": "499", "coaster": "387", "coat hanger": "400", "coffee bag": "226", "coffee grinder": "237", "coffee machine": "234", "coffee packet": "227", "coffee pot": "893", "coffee table": "356", "coins": "308", "coke bottle": "297", "collander": "694", "cologne": "176", "column": "94", "comb": "809", "comforter": "484", "computer": "46", "computer disk": "616", "conch shell": "673", "cone": "6", "console controller": "613", "console system": "518", "contact lens case": "634", "contact lens solution bottle": "173", "container": "140", "container of skin cream": "637", "cooking pan": "252", "cooking pot cover": "761", "copper vessel": "528", "cordless phone": "474", "cordless telephone": "545", "cork board": "34", "corkscrew": "713", "corn": "716", "counter": "7", "cradle": "493", "crate": "183", "crayon": "511", "cream": "635", "cream tube": "653", "crib": "485", "crock pot": "330", "cup": "35", "curtain": "89", "curtain rod": "582", "cutting board": "247", "decanter": "345", "decoration item": "842", "decorative bottle": "767", "decorative bowl": "826", "decorative candle": "865", "decorative dish": "757", "decorative egg": "862", "decorative item": "853", "decorative plate": "383", "decorative platter": "370", "deoderant": "159", "desk": "36", "desk drawer": "475", "desk mat": "473", "desser": "829", "dish brush": "248", "dish cover": "368", "dish rack": "581", "dish scrubber": "261", "dishes": "733", "dishwasher": "8", "display board": "444", "display case": "540", "display platter": "877", "dog": "701", "dog bed": "858", "dog bowl": "697", "dog cage": "703", "dog toy": "736", "doily": "892", "doll": "99", "doll house": "486", "dollar bill": "810", "dolly": "219", "door": "28", "door  window  reflection": "642", "door curtain": "663", "door facing trimreflection": "657", "door frame": "615", "door knob": "27", "door lock": "646", "door way": "609", "door way arch": "686", "doorreflection": "658", "drain": "567", "drawer": "174", "drawer handle": "371", "drawer knob": "833", "dresser": "169", "drum": "145", "drying rack": "262", "drying stand": "554", "duck": "887", "duster": "115", "dvd": "197", "dvd player": "170", "dvds": "325", "earplugs": "152", "educational display": "419", "eggplant": "888", "eggs": "699", "electric box": "550", "electric mixer": "369", "electric toothbrush": "142", "electric toothbrush base": "629", "electrical kettle": "738", "electrical outlet": "98", "electronic drumset": "816", "envelope": "476", "envelopes": "843", "eraser": "100", "ethernet jack": "118", "excercise ball": "155", "excercise equipment": "457", "excercise machine": "558", "exit sign": "86", "eye glasses": "335", "eyeball plastic ball": "787", "face wash cream": "665", "fan": "74", "faucet": "9", "faucet handle": "568", "fax machine": "68", "fiberglass case": "543", "figurine": "836", "file": "75", "file box": "734", "file container": "469", "file holder": "410", "file pad": "619", "file stand": "479", "filing shelves": "401", "fire alarm": "338", "fire extinguisher": "10", "fireplace": "372", "fish tank": "782", "flag": "405", "flashcard": "201", "flashlight": "666", "flask": "693", "flask set": "760", "flatbed scanner": "537", "flipboard": "106", "floor": "11", "floor mat": "143", "floor trim": "868", "flower": "81", "flower basket": "595", "flower box": "471", "flower pot": "146", "folder": "69", "folders": "213", "food processor": "715", "food wrapped on a tray": "752", "foosball table": "510", "foot rest": "163", "football": "166", "fork": "349", "framed certificate": "544", "fruit": "286", "fruit basket": "728", "fruit platter": "596", "fruit stand": "681", "fruitplate": "682", "frying pan": "318", "furnace": "551", "furniture": "524", "game system": "516", "game table": "429", "garage door": "850", "garbage bag": "269", "garbage bin": "12", "garlic": "763", "gate": "223", "gift wrapping": "351", "gift wrapping roll": "185", "glass": "612", "glass baking dish": "316", "glass box": "622", "glass container": "636", "glass dish": "721", "glass pane": "412", "glass pot": "304", "glass rack": "216", "glass set": "705", "glass ware": "889", "globe": "347", "globe stand": "466", "glove": "729", "gold piece": "880", "grandfather clock": "462", "grapefruit": "597", "green screen": "57", "grill": "700", "guitar": "300", "guitar case": "771", "hair brush": "120", "hair dryer": "577", "hamburger bun": "748", "hammer": "883", "hand blender": "599", "hand fan": "845", "hand sanitizer": "76", "hand sanitizer dispenser": "505", "hand sculpture": "309", "hand weight": "838", "handle": "758", "hanger": "211", "hangers": "209", "hanging hooks": "96", "hat": "193", "head phone": "586", "head phones": "584", "headband": "802", "headboard": "161", "headphones": "160", "heater": "111", "heating tray": "714", "hockey glove": "194", "hockey stick": "195", "hole puncher": "61", "hookah": "187", "hooks": "95", "hoola hoop": "512", "horse toy": "513", "hot dogs": "722", "hot water heater": "228", "humidifier": "340", "id card": "478", "incense candle": "644", "incense holder": "672", "indoor fountain": "863", "inkwell": "824", "ipad": "386", "iphone": "296", "ipod": "310", "ipod dock": "817", "iron box": "557", "iron grill": "463", "ironing board": "313", "jacket": "324", "jar": "70", "jeans": "849", "jersey": "311", "jug": "687", "juicer": "746", "karate belts": "775", "key": "378", "keyboard": "47", "kichen towel": "264", "kinect": "823", "kitchen container plastic": "739", "kitchen island": "456", "kitchen items": "253", "kitchen utensil": "266", "kitchen utensils": "753", "kiwi": "598", "knife": "259", "knife rack": "258", "knob": "652", "knobs": "600", "label": "759", "ladder": "48", "ladel": "254", "lamp": "144", "lamp shade": "859", "laptop": "37", "laundry basket": "164", "laundry detergent jug": "500", "lazy susan": "679", "lectern": "882", "leg of a girl": "409", "lego": "805", "lemon": "765", "letter stand": "620", "lid": "533", "lid of jar": "445", "life jacket": "784", "light": "62", "light bulb": "566", "light switch": "301", "light switchreflection": "659", "lighting track": "354", "lint comb": "798", "lint roller": "178", "litter box": "606", "lock": "180", "luggage": "783", "luggage rack": "803", "lunch bag": "407", "machine": "220", "magazine": "71", "magazine holder": "468", "magic 8ball": "839", "magnet": "23", "mail shelf": "65", "mail tray": "618", "mailshelf": "153", "makeup brush": "121", "manilla envelope": "63", "mantel": "58", "mantle": "874", "map": "107", "mask": "191", "matchbox": "884", "mattress": "576", "measuring cup": "730", "medal": "776", "medicine tube": "660", "mellon": "707", "menorah": "336", "mens suit": "167", "mens tie": "315", "mezuza": "531", "microphone": "818", "microphone stand": "821", "microwave": "13", "mini display platform": "869", "mirror": "122", "model boat": "789", "modem": "91", "money": "482", "monitor": "49", "mortar and pestle": "357", "motion camera": "52", "mouse": "103", "mouse pad": "539", "muffins": "229", "mug hanger": "749", "mug holder": "744", "music keyboard": "819", "music stand": "820", "music stereo": "442", "nailclipper": "569", "napkin": "244", "napkin dispenser": "230", "napkin holder": "235", "napkin ring": "350", "necklace": "341", "necklace holder": "779", "newspapers": "873", "night stand": "158", "notebook": "210", "notecards": "438", "oil container": "683", "onion": "322", "orange": "709", "orange juicer": "745", "orange plastic cap": "704", "ornamental item": "527", "ornamental plant": "459", "ornamental pot": "735", "ottoman": "359", "oven": "238", "oven handle": "366", "oven mitt": "754", "package of bedroom sheets": "807", "package of bottled water": "875", "package of water": "684", "pan": "589", "paper": "15", "paper bundle": "534", "paper cutter": "108", "paper holder": "470", "paper rack": "77", "paper towel": "113", "paper towel dispenser": "14", "paper towel holder": "281", "paper tray": "538", "paper weight": "480", "papers": "483", "peach": "710", "pen": "97", "pen box": "190", "pen cup": "786", "pen holder": "464", "pen stand": "314", "pencil": "396", "pencil holder": "101", "pepper": "885", "pepper grinder": "579", "pepper shaker": "455", "perfume": "655", "perfume box": "654", "person": "331", "personal care liquid": "649", "phone jack": "363", "photo": "508", "photo album": "864", "piano": "298", "piano bench": "460", "picture": "64", "picture of fish": "394", "piece of wood": "552", "pig": "811", "pillow": "119", "pineapple": "740", "ping pong ball": "623", "ping pong racket": "624", "ping pong racquet": "627", "ping pong table": "625", "pipe": "41", "pitcher": "273", "pizza box": "274", "placard": "420", "placemat": "154", "plant": "82", "plant pot": "239", "plaque": "231", "plastic bowl": "320", "plastic box": "395", "plastic chair": "489", "plastic crate": "402", "plastic cup of coffee": "621", "plastic dish": "723", "plastic rack": "403", "plastic toy container": "514", "plastic tray": "404", "plastic tub": "232", "plate": "233", "platter": "129", "playpen": "815", "pool ball": "520", "pool sticks": "517", "pool table": "515", "poster board": "406", "poster case": "116", "pot": "16", "potato": "323", "power surge": "451", "printer": "66", "projector": "90", "projector screen": "53", "puppy toy": "791", "purse": "181", "pyramid": "472", "quill": "793", "quilt": "575", "radiator": "236", "radio": "188", "rags": "852", "railing": "497", "range hood": "380", "razor": "632", "reflection of window shutters": "861", "refridgerator": "17", "remote control": "175", "roll of paper towels": "449", "roll of toilet paper": "674", "rolled carpet": "571", "rolled up rug": "891", "room divider": "87", "rope": "560", "router": "303", "rug": "130", "ruler": "72", "salt and pepper": "737", "salt container": "361", "salt shaker": "332", "saucer": "217", "scale": "639", "scarf": "240", "scenary": "832", "scissor": "29", "sculpture": "294", "sculpture of the chrysler building": "846", "sculpture of the eiffel tower": "847", "sculpture of the empire state building": "848", "security camera": "212", "server": "360", "serving dish": "867", "serving platter": "876", "serving spoon": "249", "sewing machine": "890", "shaver": "171", "shaving cream": "570", "sheet": "559", "sheet music": "461", "sheet of metal": "287", "sheets": "348", "shelf frame": "855", "shelves": "42", "shirts in hanger": "302", "shoe": "149", "shoe hanger": "834", "shoe rack": "614", "shoelace": "785", "shofar": "546", "shopping baskets": "222", "shopping cart": "319", "shorts": "192", "shovel": "607", "show piece": "454", "shower base": "667", "shower cap": "132", "shower curtain": "123", "shower head": "650", "shower hose": "669", "shower knob": "651", "shower pipe": "664", "shower tube": "675", "sifter": "727", "sign": "208", "sink": "24", "sink protector": "270", "six pack of beer": "382", "sleeping bag": "841", "slide": "814", "soap": "133", "soap box": "671", "soap dish": "638", "soap holder": "506", "soap stand": "640", "soap tray": "662", "soccer ball": "837", "sock": "165", "sofa": "83", "soft toy": "422", "soft toy group": "421", "spatula": "255", "speaker": "54", "spice bottle": "272", "spice rack": "241", "spice stand": "256", "sponge": "250", "spoon": "283", "spoon sets": "592", "spoon stand": "282", "spot light": "353", "squash": "717", "squeeze tube": "131", "stack of plates": "358", "stacked bins  boxes": "446", "stacked chairs": "43", "stacked plastic racks": "447", "stairs": "215", "stamp": "114", "stand": "50", "staple remover": "202", "stapler": "67", "steamer": "742", "step stool": "276", "stereo": "84", "stick": "529", "sticker": "725", "sticks": "561", "stones": "578", "stool": "150", "storage bin": "812", "storage chest": "813", "storage rack": "448", "storage shelvesbooks": "430", "storage space": "645", "stove": "242", "stove burner": "18", "stroller": "373", "stuffed animal": "177", "styrofoam object": "44", "suger jar": "741", "suit jacket": "379", "suitcase": "199", "surge protect": "611", "surge protector": "326", "switchbox": "364", "table": "19", "table runner": "375", "tablecloth": "292", "tag": "218", "tape": "109", "tape dispenser": "30", "tea box": "879", "tea cannister": "769", "tea coaster": "711", "tea kettle": "243", "tea pot": "678", "telephone": "32", "telephone cord": "31", "telescope": "467", "television": "172", "tennis racket": "626", "tent": "835", "thermostat": "110", "throw": "872", "tin foil": "265", "tissue": "648", "tissue box": "138", "tissue roll": "764", "toaster": "251", "toaster oven": "275", "toilet": "124", "toilet bowl brush": "565", "toilet brush": "630", "toilet paper": "139", "toilet paper holder": "647", "toilet plunger": "563", "toiletries": "631", "toiletries bag": "125", "toothbrush": "127", "toothbrush holder": "126", "toothpaste": "128", "toothpaste holder": "670", "torah": "894", "torch": "696", "towel": "135", "towel rod": "134", "toy": "389", "toy apple": "830", "toy bin": "417", "toy boat": "795", "toy bottle": "182", "toy box": "434", "toy car": "415", "toy cash register": "532", "toy chair": "487", "toy chest": "801", "toy cube": "423", "toy cuboid": "431", "toy cylinder": "424", "toy dog": "831", "toy doll": "465", "toy horse": "828", "toy house": "490", "toy kitchen": "751", "toy phone": "435", "toy plane": "481", "toy pyramid": "788", "toy rectangle": "425", "toy shelf": "416", "toy sink": "436", "toy sofa": "488", "toy stroller": "854", "toy table": "526", "toy tree": "432", "toy triangle": "426", "toy truck": "391", "toy trucks": "439", "toyhouse": "437", "toys basket": "390", "toys box": "496", "toys rack": "443", "toys shelf": "418", "track light": "33", "trampoline": "521", "travel bag": "799", "tray": "179", "treadmill": "458", "tree sculpture": "541", "tricycle": "522", "trinket": "844", "trivet": "257", "trolley": "504", "trolly": "221", "trophy": "547", "tub of tupperware": "604", "tumbler": "327", "tuna cans": "590", "tupperware": "762", "tv stand": "291", "typewriter": "376", "umbrella": "203", "unknown": "20", "urn": "151", "usb drive": "587", "utensil": "267", "utensil container": "362", "utensils": "317", "vacuum cleaner": "306", "vase": "78", "vasoline": "184", "vegetable": "724", "vegetable peeler": "277", "vegetables": "719", "vessel": "263", "vessel set": "706", "vessels": "601", "vhs tapes": "871", "video game": "519", "vuvuzela": "196", "waffle maker": "288", "walkie talkie": "398", "walkietalkie": "866", "wall": "21", "wall decoration": "186", "wall divider": "800", "wall hand sanitizer dispenser": "440", "wall stand": "295", "wallet": "661", "wardrobe": "772", "washing machine": "278", "watch": "384", "water carboy": "102", "water cooler": "509", "water dispenser": "507", "water filter": "731", "water fountain": "339", "water heater": "588", "water purifier": "93", "watermellon": "718", "webcam": "781", "whisk": "367", "whiteboard": "45", "whiteboard eraser": "388", "whiteboard marker": "117", "wii": "523", "window": "59", "window box": "778", "window cover": "573", "window frame": "477", "window seat": "777", "window shelf": "668", "wine": "766", "wine accessory": "732", "wine bottle": "333", "wine glass": "293", "wine rack": "299", "wire": "92", "wire basket": "603", "wire board": "792", "wire rack": "105", "wire tray": "768", "wooden container": "321", "wooden kitchen utensils": "284", "wooden pillar": "553", "wooden plank": "698", "wooden planks": "562", "wooden toy": "433", "wooden utensil": "756", "wooden utensils": "346", "wreathe": "881", "xbox": "628", "yarmulka": "806", "yellow pepper": "886", "yoga mat": "205"}
    IDS_TO_NAMES = {"79": "air conditioner", "38": "air duct", "25": "air vent", "525": "alarm", "156": "alarm clock", "822": "album", "708": "aluminium foil", "870": "american flag", "796": "antenna", "334": "apple", "377": "ashtray", "680": "avocado", "494": "baby chair", "591": "baby gate", "656": "back scrubber", "206": "backpack", "55": "bag", "690": "bag of bagels", "245": "bag of chips", "285": "bag of flour", "747": "bag of hot dog buns", "692": "bag of oreo", "689": "bagel", "260": "baking dish", "60": "ball", "385": "balloon", "147": "banana", "691": "banana peel", "453": "banister", "51": "bar", "564": "bar of soap", "343": "barrel", "825": "baseball", "39": "basket", "542": "basketball", "162": "basketball hoop", "414": "bassinet", "136": "bathtub", "797": "bean bag", "157": "bed", "352": "bed sheets", "808": "bedding package", "780": "beeper", "610": "belt", "204": "bench", "189": "bicycle", "337": "bicycle helmet", "307": "bin", "399": "binder", "225": "blackboard", "312": "blanket", "268": "blender", "80": "blinds", "408": "board", "1": "book", "827": "book holder", "374": "bookend", "224": "bookrack", "85": "books", "88": "bookshelf", "773": "boomerang", "2": "bottle", "755": "bottle of comet", "633": "bottle of contact lens solution", "677": "bottle of hand wash liquid", "750": "bottle of ketchup", "685": "bottle of liquid", "676": "bottle of listerine", "840": "bottle of perfume", "502": "bottle of soap", "22": "bowl", "26": "box", "503": "box of paper", "271": "box of ziplock bags", "860": "bracelet", "246": "bread", "695": "brick", "617": "briefcase", "328": "broom", "427": "bucket", "688": "bulb", "804": "bunk bed", "535": "business cards", "712": "butterfly sculpture", "774": "button", "3": "cabinet", "168": "cable box", "73": "cable modem", "104": "cable rack", "450": "cables", "641": "cactus", "289": "cake", "200": "calculator", "583": "calendar", "40": "camera", "329": "can", "857": "can of beer", "280": "can of food", "279": "can opener", "605": "candelabra", "137": "candle", "148": "candlestick", "555": "cane", "794": "canister", "355": "cannister", "593": "cans of cat food", "441": "cap stand", "530": "car", "452": "cardboard sheet", "413": "cardboard tube", "305": "cart", "397": "carton", "851": "case", "365": "casserole dish", "594": "cat", "608": "cat bed", "580": "cat cage", "856": "cat house", "207": "cd", "585": "cd disc", "4": "ceiling", "720": "celery", "290": "cell phone", "602": "cell phone charger", "878": "centerpiece", "643": "ceramic frog", "790": "certificate", "5": "chair", "428": "chalkboard", "342": "chandelier", "726": "chapstick", "743": "charger", "574": "charger and wire", "411": "chart", "495": "chart roll", "393": "chart stand", "198": "chessboard", "344": "chest", "491": "child carrier", "702": "chimney", "112": "circuit breaker box", "392": "classroom board", "548": "cleaner", "381": "cleaning wipes", "536": "clipboard", "56": "clock", "492": "cloth bag", "549": "cloth drying stand", "141": "clothes", "501": "clothing detergent", "498": "clothing dryer", "556": "clothing drying rack", "770": "clothing hamper", "214": "clothing hanger", "572": "clothing iron", "499": "clothing washer", "387": "coaster", "400": "coat hanger", "226": "coffee bag", "237": "coffee grinder", "234": "coffee machine", "227": "coffee packet", "893": "coffee pot", "356": "coffee table", "308": "coins", "297": "coke bottle", "694": "collander", "176": "cologne", "94": "column", "809": "comb", "484": "comforter", "46": "computer", "616": "computer disk", "673": "conch shell", "6": "cone", "613": "console controller", "518": "console system", "634": "contact lens case", "173": "contact lens solution bottle", "140": "container", "637": "container of skin cream", "252": "cooking pan", "761": "cooking pot cover", "528": "copper vessel", "474": "cordless phone", "545": "cordless telephone", "34": "cork board", "713": "corkscrew", "716": "corn", "7": "counter", "493": "cradle", "183": "crate", "511": "crayon", "635": "cream", "653": "cream tube", "485": "crib", "330": "crock pot", "35": "cup", "89": "curtain", "582": "curtain rod", "247": "cutting board", "345": "decanter", "842": "decoration item", "767": "decorative bottle", "826": "decorative bowl", "865": "decorative candle", "757": "decorative dish", "862": "decorative egg", "853": "decorative item", "383": "decorative plate", "370": "decorative platter", "159": "deoderant", "36": "desk", "475": "desk drawer", "473": "desk mat", "829": "desser", "248": "dish brush", "368": "dish cover", "581": "dish rack", "261": "dish scrubber", "733": "dishes", "8": "dishwasher", "444": "display board", "540": "display case", "877": "display platter", "701": "dog", "858": "dog bed", "697": "dog bowl", "703": "dog cage", "736": "dog toy", "892": "doily", "99": "doll", "486": "doll house", "810": "dollar bill", "219": "dolly", "28": "door", "642": "door  window  reflection", "663": "door curtain", "657": "door facing trimreflection", "615": "door frame", "27": "door knob", "646": "door lock", "609": "door way", "686": "door way arch", "658": "doorreflection", "567": "drain", "174": "drawer", "371": "drawer handle", "833": "drawer knob", "169": "dresser", "145": "drum", "262": "drying rack", "554": "drying stand", "887": "duck", "115": "duster", "197": "dvd", "170": "dvd player", "325": "dvds", "152": "earplugs", "419": "educational display", "888": "eggplant", "699": "eggs", "550": "electric box", "369": "electric mixer", "142": "electric toothbrush", "629": "electric toothbrush base", "738": "electrical kettle", "98": "electrical outlet", "816": "electronic drumset", "476": "envelope", "843": "envelopes", "100": "eraser", "118": "ethernet jack", "155": "excercise ball", "457": "excercise equipment", "558": "excercise machine", "86": "exit sign", "335": "eye glasses", "787": "eyeball plastic ball", "665": "face wash cream", "74": "fan", "9": "faucet", "568": "faucet handle", "68": "fax machine", "543": "fiberglass case", "836": "figurine", "75": "file", "734": "file box", "469": "file container", "410": "file holder", "619": "file pad", "479": "file stand", "401": "filing shelves", "338": "fire alarm", "10": "fire extinguisher", "372": "fireplace", "782": "fish tank", "405": "flag", "201": "flashcard", "666": "flashlight", "693": "flask", "760": "flask set", "537": "flatbed scanner", "106": "flipboard", "11": "floor", "143": "floor mat", "868": "floor trim", "81": "flower", "595": "flower basket", "471": "flower box", "146": "flower pot", "69": "folder", "213": "folders", "715": "food processor", "752": "food wrapped on a tray", "510": "foosball table", "163": "foot rest", "166": "football", "349": "fork", "544": "framed certificate", "286": "fruit", "728": "fruit basket", "596": "fruit platter", "681": "fruit stand", "682": "fruitplate", "318": "frying pan", "551": "furnace", "524": "furniture", "516": "game system", "429": "game table", "850": "garage door", "269": "garbage bag", "12": "garbage bin", "763": "garlic", "223": "gate", "351": "gift wrapping", "185": "gift wrapping roll", "612": "glass", "316": "glass baking dish", "622": "glass box", "636": "glass container", "721": "glass dish", "412": "glass pane", "304": "glass pot", "216": "glass rack", "705": "glass set", "889": "glass ware", "347": "globe", "466": "globe stand", "729": "glove", "880": "gold piece", "462": "grandfather clock", "597": "grapefruit", "57": "green screen", "700": "grill", "300": "guitar", "771": "guitar case", "120": "hair brush", "577": "hair dryer", "748": "hamburger bun", "883": "hammer", "599": "hand blender", "845": "hand fan", "76": "hand sanitizer", "505": "hand sanitizer dispenser", "309": "hand sculpture", "838": "hand weight", "758": "handle", "211": "hanger", "209": "hangers", "96": "hanging hooks", "193": "hat", "586": "head phone", "584": "head phones", "802": "headband", "161": "headboard", "160": "headphones", "111": "heater", "714": "heating tray", "194": "hockey glove", "195": "hockey stick", "61": "hole puncher", "187": "hookah", "95": "hooks", "512": "hoola hoop", "513": "horse toy", "722": "hot dogs", "228": "hot water heater", "340": "humidifier", "478": "id card", "644": "incense candle", "672": "incense holder", "863": "indoor fountain", "824": "inkwell", "386": "ipad", "296": "iphone", "310": "ipod", "817": "ipod dock", "557": "iron box", "463": "iron grill", "313": "ironing board", "324": "jacket", "70": "jar", "849": "jeans", "311": "jersey", "687": "jug", "746": "juicer", "775": "karate belts", "378": "key", "47": "keyboard", "264": "kichen towel", "823": "kinect", "739": "kitchen container plastic", "456": "kitchen island", "253": "kitchen items", "266": "kitchen utensil", "753": "kitchen utensils", "598": "kiwi", "259": "knife", "258": "knife rack", "652": "knob", "600": "knobs", "759": "label", "48": "ladder", "254": "ladel", "144": "lamp", "859": "lamp shade", "37": "laptop", "164": "laundry basket", "500": "laundry detergent jug", "679": "lazy susan", "882": "lectern", "409": "leg of a girl", "805": "lego", "765": "lemon", "620": "letter stand", "533": "lid", "445": "lid of jar", "784": "life jacket", "62": "light", "566": "light bulb", "301": "light switch", "659": "light switchreflection", "354": "lighting track", "798": "lint comb", "178": "lint roller", "606": "litter box", "180": "lock", "783": "luggage", "803": "luggage rack", "407": "lunch bag", "220": "machine", "71": "magazine", "468": "magazine holder", "839": "magic 8ball", "23": "magnet", "65": "mail shelf", "618": "mail tray", "153": "mailshelf", "121": "makeup brush", "63": "manilla envelope", "58": "mantel", "874": "mantle", "107": "map", "191": "mask", "884": "matchbox", "576": "mattress", "730": "measuring cup", "776": "medal", "660": "medicine tube", "707": "mellon", "336": "menorah", "167": "mens suit", "315": "mens tie", "531": "mezuza", "818": "microphone", "821": "microphone stand", "13": "microwave", "869": "mini display platform", "122": "mirror", "789": "model boat", "91": "modem", "482": "money", "49": "monitor", "357": "mortar and pestle", "52": "motion camera", "103": "mouse", "539": "mouse pad", "229": "muffins", "749": "mug hanger", "744": "mug holder", "819": "music keyboard", "820": "music stand", "442": "music stereo", "569": "nailclipper", "244": "napkin", "230": "napkin dispenser", "235": "napkin holder", "350": "napkin ring", "341": "necklace", "779": "necklace holder", "873": "newspapers", "158": "night stand", "210": "notebook", "438": "notecards", "683": "oil container", "322": "onion", "709": "orange", "745": "orange juicer", "704": "orange plastic cap", "527": "ornamental item", "459": "ornamental plant", "735": "ornamental pot", "359": "ottoman", "238": "oven", "366": "oven handle", "754": "oven mitt", "807": "package of bedroom sheets", "875": "package of bottled water", "684": "package of water", "589": "pan", "15": "paper", "534": "paper bundle", "108": "paper cutter", "470": "paper holder", "77": "paper rack", "113": "paper towel", "14": "paper towel dispenser", "281": "paper towel holder", "538": "paper tray", "480": "paper weight", "483": "papers", "710": "peach", "97": "pen", "190": "pen box", "786": "pen cup", "464": "pen holder", "314": "pen stand", "396": "pencil", "101": "pencil holder", "885": "pepper", "579": "pepper grinder", "455": "pepper shaker", "655": "perfume", "654": "perfume box", "331": "person", "649": "personal care liquid", "363": "phone jack", "508": "photo", "864": "photo album", "298": "piano", "460": "piano bench", "64": "picture", "394": "picture of fish", "552": "piece of wood", "811": "pig", "119": "pillow", "740": "pineapple", "623": "ping pong ball", "624": "ping pong racket", "627": "ping pong racquet", "625": "ping pong table", "41": "pipe", "273": "pitcher", "274": "pizza box", "420": "placard", "154": "placemat", "82": "plant", "239": "plant pot", "231": "plaque", "320": "plastic bowl", "395": "plastic box", "489": "plastic chair", "402": "plastic crate", "621": "plastic cup of coffee", "723": "plastic dish", "403": "plastic rack", "514": "plastic toy container", "404": "plastic tray", "232": "plastic tub", "233": "plate", "129": "platter", "815": "playpen", "520": "pool ball", "517": "pool sticks", "515": "pool table", "406": "poster board", "116": "poster case", "16": "pot", "323": "potato", "451": "power surge", "66": "printer", "90": "projector", "53": "projector screen", "791": "puppy toy", "181": "purse", "472": "pyramid", "793": "quill", "575": "quilt", "236": "radiator", "188": "radio", "852": "rags", "497": "railing", "380": "range hood", "632": "razor", "861": "reflection of window shutters", "17": "refridgerator", "175": "remote control", "449": "roll of paper towels", "674": "roll of toilet paper", "571": "rolled carpet", "891": "rolled up rug", "87": "room divider", "560": "rope", "303": "router", "130": "rug", "72": "ruler", "737": "salt and pepper", "361": "salt container", "332": "salt shaker", "217": "saucer", "639": "scale", "240": "scarf", "832": "scenary", "29": "scissor", "294": "sculpture", "846": "sculpture of the chrysler building", "847": "sculpture of the eiffel tower", "848": "sculpture of the empire state building", "212": "security camera", "360": "server", "867": "serving dish", "876": "serving platter", "249": "serving spoon", "890": "sewing machine", "171": "shaver", "570": "shaving cream", "559": "sheet", "461": "sheet music", "287": "sheet of metal", "348": "sheets", "855": "shelf frame", "42": "shelves", "302": "shirts in hanger", "149": "shoe", "834": "shoe hanger", "614": "shoe rack", "785": "shoelace", "546": "shofar", "222": "shopping baskets", "319": "shopping cart", "192": "shorts", "607": "shovel", "454": "show piece", "667": "shower base", "132": "shower cap", "123": "shower curtain", "650": "shower head", "669": "shower hose", "651": "shower knob", "664": "shower pipe", "675": "shower tube", "727": "sifter", "208": "sign", "24": "sink", "270": "sink protector", "382": "six pack of beer", "841": "sleeping bag", "814": "slide", "133": "soap", "671": "soap box", "638": "soap dish", "506": "soap holder", "640": "soap stand", "662": "soap tray", "837": "soccer ball", "165": "sock", "83": "sofa", "422": "soft toy", "421": "soft toy group", "255": "spatula", "54": "speaker", "272": "spice bottle", "241": "spice rack", "256": "spice stand", "250": "sponge", "283": "spoon", "592": "spoon sets", "282": "spoon stand", "353": "spot light", "717": "squash", "131": "squeeze tube", "358": "stack of plates", "446": "stacked bins  boxes", "43": "stacked chairs", "447": "stacked plastic racks", "215": "stairs", "114": "stamp", "50": "stand", "202": "staple remover", "67": "stapler", "742": "steamer", "276": "step stool", "84": "stereo", "529": "stick", "725": "sticker", "561": "sticks", "578": "stones", "150": "stool", "812": "storage bin", "813": "storage chest", "448": "storage rack", "430": "storage shelvesbooks", "645": "storage space", "242": "stove", "18": "stove burner", "373": "stroller", "177": "stuffed animal", "44": "styrofoam object", "741": "suger jar", "379": "suit jacket", "199": "suitcase", "611": "surge protect", "326": "surge protector", "364": "switchbox", "19": "table", "375": "table runner", "292": "tablecloth", "218": "tag", "109": "tape", "30": "tape dispenser", "879": "tea box", "769": "tea cannister", "711": "tea coaster", "243": "tea kettle", "678": "tea pot", "32": "telephone", "31": "telephone cord", "467": "telescope", "172": "television", "626": "tennis racket", "835": "tent", "110": "thermostat", "872": "throw", "265": "tin foil", "648": "tissue", "138": "tissue box", "764": "tissue roll", "251": "toaster", "275": "toaster oven", "124": "toilet", "565": "toilet bowl brush", "630": "toilet brush", "139": "toilet paper", "647": "toilet paper holder", "563": "toilet plunger", "631": "toiletries", "125": "toiletries bag", "127": "toothbrush", "126": "toothbrush holder", "128": "toothpaste", "670": "toothpaste holder", "894": "torah", "696": "torch", "135": "towel", "134": "towel rod", "389": "toy", "830": "toy apple", "417": "toy bin", "795": "toy boat", "182": "toy bottle", "434": "toy box", "415": "toy car", "532": "toy cash register", "487": "toy chair", "801": "toy chest", "423": "toy cube", "431": "toy cuboid", "424": "toy cylinder", "831": "toy dog", "465": "toy doll", "828": "toy horse", "490": "toy house", "751": "toy kitchen", "435": "toy phone", "481": "toy plane", "788": "toy pyramid", "425": "toy rectangle", "416": "toy shelf", "436": "toy sink", "488": "toy sofa", "854": "toy stroller", "526": "toy table", "432": "toy tree", "426": "toy triangle", "391": "toy truck", "439": "toy trucks", "437": "toyhouse", "390": "toys basket", "496": "toys box", "443": "toys rack", "418": "toys shelf", "33": "track light", "521": "trampoline", "799": "travel bag", "179": "tray", "458": "treadmill", "541": "tree sculpture", "522": "tricycle", "844": "trinket", "257": "trivet", "504": "trolley", "221": "trolly", "547": "trophy", "604": "tub of tupperware", "327": "tumbler", "590": "tuna cans", "762": "tupperware", "291": "tv stand", "376": "typewriter", "203": "umbrella", "20": "unknown", "151": "urn", "587": "usb drive", "267": "utensil", "362": "utensil container", "317": "utensils", "306": "vacuum cleaner", "78": "vase", "184": "vasoline", "724": "vegetable", "277": "vegetable peeler", "719": "vegetables", "263": "vessel", "706": "vessel set", "601": "vessels", "871": "vhs tapes", "519": "video game", "196": "vuvuzela", "288": "waffle maker", "398": "walkie talkie", "866": "walkietalkie", "21": "wall", "186": "wall decoration", "800": "wall divider", "440": "wall hand sanitizer dispenser", "295": "wall stand", "661": "wallet", "772": "wardrobe", "278": "washing machine", "384": "watch", "102": "water carboy", "509": "water cooler", "507": "water dispenser", "731": "water filter", "339": "water fountain", "588": "water heater", "93": "water purifier", "718": "watermellon", "781": "webcam", "367": "whisk", "45": "whiteboard", "388": "whiteboard eraser", "117": "whiteboard marker", "523": "wii", "59": "window", "778": "window box", "573": "window cover", "477": "window frame", "777": "window seat", "668": "window shelf", "766": "wine", "732": "wine accessory", "333": "wine bottle", "293": "wine glass", "299": "wine rack", "92": "wire", "603": "wire basket", "792": "wire board", "105": "wire rack", "768": "wire tray", "321": "wooden container", "284": "wooden kitchen utensils", "553": "wooden pillar", "698": "wooden plank", "562": "wooden planks", "433": "wooden toy", "756": "wooden utensil", "346": "wooden utensils", "881": "wreathe", "628": "xbox", "806": "yarmulka", "886": "yellow pepper", "205": "yoga mat"}

    def __init__(self, path="datasets/nyu"):
        self._base_path = path

    def fetch(self):

        if not os.path.isfile(os.path.join(self._base_path, ".downloaded")):

            # Load the dataset if there doesn't exist the dataset archive
            if not os.path.exists(self._base_path):
                os.makedirs(self._base_path)
            # try:
            #     shutil.rmtree(path)
            # except FileNotFoundError:
            #     os.makedirs(path)

            # Download annotation archive
            _download(self.DATASET_URL, self._base_path)

            # Create the empty file as flag for download status
            with open(os.path.join(self._base_path, ".downloaded"), "w"):
                pass

    def load(self):
        import mat73
        data = mat73.loadmat(os.path.join(self._base_path, self.MAT_FILENAME))
        data["namesToIds"] = self.NAMES_TO_IDS
        data["idsToNames"] = self.IDS_TO_NAMES
        data["images"] = data["images"].transpose(3, 0, 1, 2).astype(np.uint8)
        data["labels"] = data["labels"].transpose(2, 0, 1).astype(np.uint16)
        data["instances"] = data["instances"].transpose(2, 0, 1).astype(np.uint8)
        data["depths"] = data["depths"].transpose(2, 0, 1)
        return data

    def fetch_load(self):
        self.fetch()
        return self.load()
